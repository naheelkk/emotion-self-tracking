<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Minimalist Brain Icon encoded directly as code (no external file needed!) -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><rect width='24' height='24' rx='12' fill='%23050505'/><g fill='none' stroke='%23e5e5e5' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'><path d='M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z'/><path d='M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z'/><path d='M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4'/></g></svg>">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gentle Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    body {
      background-color: #050505;
      color: #e5e5e5;
      font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      margin: 0;
      overflow-x: hidden;
    }
    
    /* Smooth transitions for the UI */
    .transition-all {
      transition-property: all;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-duration: 300ms;
    }

    /* Custom scrollbar for minimalist look */
    ::-webkit-scrollbar {
      width: 6px;
    }
    ::-webkit-scrollbar-track {
      background: #050505; 
    }
    ::-webkit-scrollbar-thumb {
      background: #333; 
      border-radius: 10px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #555; 
    }

    #neural-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 0;
      pointer-events: none;
      opacity: 0.4;
    }

    #app {
      position: relative;
      z-index: 10;
    }

    .toast-enter {
      animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }

    @keyframes slideUp {
      from { transform: translate(-50%, 100%); opacity: 0; }
      to { transform: translate(-50%, 0); opacity: 1; }
    }
  </style>
</head>
<body class="antialiased selection:bg-white selection:text-black">

  <!-- Neural Network Background -->
  <canvas id="neural-canvas"></canvas>

  <div id="app" class="max-w-2xl mx-auto px-6 py-12 min-h-screen flex flex-col">
    <!-- Header -->
    <header class="flex flex-col items-center justify-center py-8 mb-8 border-b border-neutral-800">
      <div class="mb-6">
        <i data-lucide="brain" class="w-12 h-12 text-white"></i>
      </div>
      <h1 class="text-2xl font-light tracking-widest uppercase text-white mb-2">
        Mind Log
      </h1>
      <p class="text-neutral-500 text-sm text-center max-w-sm">
        Observe your thoughts without judgment.
      </p>
    </header>

    <!-- Navigation -->
    <div class="flex justify-center mb-10">
      <div class="p-1 rounded-full border border-neutral-800 inline-flex bg-neutral-950/50 backdrop-blur-md">
        <button id="tab-today" class="px-8 py-2 rounded-full text-xs tracking-wider uppercase transition-all bg-white text-black font-medium">
          Today
        </button>
        <button id="tab-history" class="px-8 py-2 rounded-full text-xs tracking-wider uppercase transition-all text-neutral-500 hover:text-white">
          History
        </button>
      </div>
    </div>

    <!-- Main Content Area -->
    <main id="main-content" class="flex-grow">
      <!-- Content injected via JS -->
    </main>

    <!-- Footer -->
    <footer class="mt-20 text-center text-neutral-600 text-xs tracking-widest uppercase pb-6">
      <p>Observe &bull; Accept &bull; Release</p>
    </footer>
  </div>

  <!-- Toast Notification Container -->
  <div id="toast-container" class="fixed bottom-8 left-1/2 transform -translate-x-1/2 z-50 pointer-events-none hidden">
    <div class="bg-white text-black px-6 py-3 rounded-full flex items-center gap-3 shadow-[0_0_20px_rgba(255,255,255,0.1)]">
      <i data-lucide="check" class="w-4 h-4"></i>
      <span id="toast-message" class="text-sm font-medium tracking-wide">Logged</span>
    </div>
  </div>

  <script>
    // --- State & Constants ---
    const TRACKERS = [
      { id: 'overthink', label: 'Overthinking', desc: 'Caught in a loop of thoughts', icon: 'git-commit' },
      { id: 'cry', label: 'Crying', desc: 'Released emotions', icon: 'droplets' },
      { id: 'trauma', label: 'Past Trauma', desc: 'Felt pulled into the past', icon: 'rotate-ccw' },
      { id: 'isolate', label: 'Isolation', desc: 'Withdrew from others', icon: 'user-minus' },
      { id: 'anxiety', label: 'Anxiety', desc: 'Felt overwhelmed or tense', icon: 'wind' },
      { id: 'selfcare', label: 'Self-compassion', desc: 'Was kind to myself anyway', icon: 'heart' },
    ];

    let state = {
      activeTab: 'today',
      todayData: {},
      entries: {}
    };

    const getTodayStr = () => new Date().toISOString().split('T')[0];
    const todayStr = getTodayStr();
    const STORAGE_KEY = 'mind_log_entries';

    const initStorage = () => {
      const stored = localStorage.getItem(STORAGE_KEY);
      if (stored) {
        try {
          state.entries = JSON.parse(stored);
          if (state.entries[todayStr] && Object.keys(state.todayData).length === 0) {
            state.todayData = { ...state.entries[todayStr] };
          }
        } catch(err) {
          console.error("Could not load local data", err);
        }
      }
    };

    const saveTodayToLocal = () => {
      state.entries[todayStr] = { ...state.todayData };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state.entries));
      showToast("Entry saved to your device.");
    };

    // --- UI Rendering ---
    const mainContent = document.getElementById('main-content');
    const tabToday = document.getElementById('tab-today');
    const tabHistory = document.getElementById('tab-history');

    const toggleTracker = (id) => {
      state.todayData[id] = !state.todayData[id];
      render();
    };

    const formatDate = (dateStr) => {
      const options = { weekday: 'long', month: 'long', day: 'numeric' };
      return new Date(dateStr).toLocaleDateString('en-US', options);
    };

    const showToast = (msg) => {
      const toast = document.getElementById('toast-container');
      const toastMsg = document.getElementById('toast-message');
      toastMsg.textContent = msg;
      toast.classList.remove('hidden');
      toast.classList.add('toast-enter');
      
      setTimeout(() => {
        toast.classList.add('hidden');
        toast.classList.remove('toast-enter');
      }, 3000);
    };

    const renderToday = () => {
      let html = `<div class="grid grid-cols-1 md:grid-cols-2 gap-4 animate-[fadeIn_0.5s_ease-out]">`;
      
      TRACKERS.forEach(tracker => {
        const isActive = state.todayData[tracker.id];
        
        const baseClasses = "flex flex-col p-5 border rounded-xl transition-all duration-300 text-left cursor-pointer group";
        const stateClasses = isActive 
          ? "bg-white text-black border-white scale-[1.02]" 
          : "bg-transparent text-neutral-400 border-neutral-800 hover:border-neutral-500 hover:text-neutral-200";
        
        const iconColor = isActive ? "text-black" : "text-neutral-500 group-hover:text-neutral-300";

        html += `
          <button data-tracker-id="${tracker.id}" class="tracker-btn ${baseClasses} ${stateClasses}">
            <div class="flex items-center justify-between mb-3">
              <i data-lucide="${tracker.icon}" class="w-6 h-6 ${iconColor} transition-colors"></i>
              ${isActive ? `<i data-lucide="check" class="w-5 h-5 text-black"></i>` : ''}
            </div>
            <span class="text-lg font-medium tracking-wide">${tracker.label}</span>
            <span class="${isActive ? 'text-neutral-600' : 'text-neutral-600 group-hover:text-neutral-400'} text-xs mt-1 transition-colors">${tracker.desc}</span>
          </button>
        `;
      });

      html += `</div>
        <div class="mt-6 animate-[fadeIn_0.5s_ease-out]">
          <textarea id="reflection-input" rows="3" class="w-full bg-neutral-950/50 border border-neutral-800 hover:border-neutral-700 focus:border-neutral-500 rounded-xl p-4 text-sm text-neutral-200 placeholder-neutral-700 focus:outline-none transition-colors resize-y" placeholder="Any reflections or notes? (Optional)">${state.todayData.reflection || ''}</textarea>
        </div>
        <div class="mt-10 flex justify-center">
          <button id="save-btn" class="px-10 py-3 bg-neutral-900 border border-neutral-700 text-white hover:bg-white hover:text-black hover:border-white transition-all rounded-full tracking-widest uppercase text-xs font-semibold">
            Commit Log
          </button>
        </div>`;
      
      mainContent.innerHTML = html;

      // Attach event listeners for today view
      document.querySelectorAll('.tracker-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const id = e.currentTarget.getAttribute('data-tracker-id');
          toggleTracker(id);
        });
      });

      document.getElementById('reflection-input').addEventListener('input', (e) => {
        state.todayData.reflection = e.target.value;
      });

      document.getElementById('save-btn').addEventListener('click', saveTodayToLocal);
    };

    const renderHistory = () => {
      const dates = Object.keys(state.entries).sort((a, b) => new Date(b) - new Date(a));
      
      if (dates.length === 0) {
        mainContent.innerHTML = `
          <div class="flex flex-col items-center justify-center text-neutral-600 py-20 text-center animate-[fadeIn_0.5s_ease-out]">
            <i data-lucide="activity" class="w-12 h-12 mb-4 opacity-20"></i>
            <p class="tracking-widest uppercase text-xs">No records found</p>
          </div>
        `;
        return;
      }

      let html = `<div class="space-y-4 animate-[fadeIn_0.5s_ease-out]">`;
      
      dates.forEach(dateStr => {
        const dayData = state.entries[dateStr];
        const activeTrackers = TRACKERS.filter(t => dayData[t.id]);
        
        html += `
          <div class="border border-neutral-800 p-6 rounded-xl bg-neutral-950/50">
            <h3 class="text-white font-medium mb-4 text-sm tracking-widest uppercase flex items-center gap-2">
              <i data-lucide="calendar" class="w-4 h-4 text-neutral-500"></i>
              ${dateStr === todayStr ? 'Today' : formatDate(dateStr)}
            </h3>
            
            <div class="flex flex-wrap gap-2">
        `;

        if (activeTrackers.length > 0) {
          activeTrackers.forEach(t => {
            html += `
              <span class="inline-flex items-center gap-1.5 px-3 py-1 text-xs border border-neutral-700 rounded-full text-neutral-300 bg-neutral-900">
                <i data-lucide="${t.icon}" class="w-3 h-3"></i>
                ${t.label}
              </span>
            `;
          });
        } else {
          html += `<span class="text-neutral-600 text-sm italic">Mind was quiet.</span>`;
        }

        html += `</div>`;

        if (dayData.reflection && dayData.reflection.trim() !== '') {
          html += `
            <div class="mt-4 pt-4 border-t border-neutral-800/50">
              <p class="text-sm text-neutral-400 whitespace-pre-wrap leading-relaxed">${dayData.reflection}</p>
            </div>
          `;
        }

        html += `</div>`;
      });

      html += `</div>`;
      mainContent.innerHTML = html;
    };

    const render = () => {
      if (state.activeTab === 'today') {
        tabToday.className = "px-8 py-2 rounded-full text-xs tracking-wider uppercase transition-all bg-white text-black font-medium";
        tabHistory.className = "px-8 py-2 rounded-full text-xs tracking-wider uppercase transition-all text-neutral-500 hover:text-white";
        renderToday();
      } else {
        tabHistory.className = "px-8 py-2 rounded-full text-xs tracking-wider uppercase transition-all bg-white text-black font-medium";
        tabToday.className = "px-8 py-2 rounded-full text-xs tracking-wider uppercase transition-all text-neutral-500 hover:text-white";
        renderHistory();
      }
      lucide.createIcons();
    };

    // Tab Listeners
    tabToday.addEventListener('click', () => { state.activeTab = 'today'; render(); });
    tabHistory.addEventListener('click', () => { state.activeTab = 'history'; render(); });

    // --- Canvas Neural Network Animation ---
    const canvas = document.getElementById('neural-canvas');
    const ctx = canvas.getContext('2d');
    let width, height;
    let particles = [];
    const connectionDistance = 120;

    const initCanvas = () => {
      width = canvas.width = window.innerWidth;
      height = canvas.height = window.innerHeight;
      particles = [];
      const numParticles = Math.floor((width * height) / 15000); // Responsive particle count
      
      for(let i = 0; i < numParticles; i++) {
        particles.push({
          x: Math.random() * width,
          y: Math.random() * height,
          vx: (Math.random() - 0.5) * 0.3,
          vy: (Math.random() - 0.5) * 0.3
        });
      }
    };

    const animateCanvas = () => {
      ctx.clearRect(0, 0, width, height);
      
      // Draw lines
      ctx.lineWidth = 0.5;
      for(let i = 0; i < particles.length; i++) {
        for(let j = i + 1; j < particles.length; j++) {
          const dx = particles[i].x - particles[j].x;
          const dy = particles[i].y - particles[j].y;
          const dist = Math.sqrt(dx * dx + dy * dy);
          
          if(dist < connectionDistance) {
            const opacity = 1 - (dist / connectionDistance);
            ctx.strokeStyle = `rgba(255, 255, 255, ${opacity * 0.3})`;
            ctx.beginPath();
            ctx.moveTo(particles[i].x, particles[i].y);
            ctx.lineTo(particles[j].x, particles[j].y);
            ctx.stroke();
          }
        }
      }

      // Draw and move particles
      ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
      for(let i = 0; i < particles.length; i++) {
        let p = particles[i];
        p.x += p.vx;
        p.y += p.vy;

        // Bounce off edges
        if(p.x < 0 || p.x > width) p.vx *= -1;
        if(p.y < 0 || p.y > height) p.vy *= -1;

        ctx.beginPath();
        ctx.arc(p.x, p.y, 1.5, 0, Math.PI * 2);
        ctx.fill();
      }

      requestAnimationFrame(animateCanvas);
    };

    // Add interactivity to nodes
    document.addEventListener('mousemove', (e) => {
      if(particles.length > 0) {
        // Gently pull the first few particles toward mouse to create a "thought focus" effect
        for(let i = 0; i < 3; i++) {
            particles[i].vx += (e.clientX - particles[i].x) * 0.0001;
            particles[i].vy += (e.clientY - particles[i].y) * 0.0001;
        }
      }
    });

    window.addEventListener('resize', initCanvas);

    // --- Boot ---
    initCanvas();
    animateCanvas();
    initStorage();
    render();

    // Keyframes for fade in
    const style = document.createElement('style');
    style.innerHTML = `
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
    `;
    document.head.appendChild(style);

  </script>
</body>
</html>
